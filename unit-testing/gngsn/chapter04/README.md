# CHAPTER 4. 좋은 단위 테스트의 4대 요소

**TL;DR**

<br/><br/>

---

<br/>

### 1. 좋은 테스트의 4대 요소

#### 1.1 회귀 방지

회귀: 소프트웨어 버그, 코드를 수정한 후 (일반적으로 새 기능을 출시한 후) 기능이 의도한 대로 작동하지 않는 경우

- 코드는 자산이 아니라 책임이며, 잠재적인 버그에 더 많이 노출됨 
- 회귀를 방지해야 프로젝트가 오래 성장할 수 있고 버그의 누적을 막을 수 있음

<br/>

**회귀 방지를 위해 고려할 점**
- 테스트 실행 코드의 양
- 코드 복잡도
  - 복잡한 비즈니스 로직을 나타내는 코드가 boilerplate 보다 훨씬 중요
  - 중요한 비즈니스 코드에서 발생한 코드가 가장 치명적
- 코드의 도메인 유의성
- 본인이 작성한 코드 외의 기반 코드
  - 가령 라이브러리, 프레임워크, 외부 시스템 등

회귀 방지 지표를 극대화하려면 테스트가 가능한 많은 코드를 실행하는 것을 목표로 해야함

<br/>

#### 1.2 리팩터링 내성

- 테스트를 실패로 바꾸지 않고 기본 애플리케이션 코드를 리팩터링할 수 있는지에 대한 척도

<pre>
<b>리팩터링</b>
: 식별할 수 있는 동작을 수정하지 않고 기존 코드를 변경하는 것
- 의도: 코드의 비기능적 특징 개선. 가독성을 높이고 복잡도를 낮추는 것,
ex. 메서드 이름을 바꾸는 것, 코드 조각을 새로운 클래스로 추출하는 것
</pre>

거짓 양성: false positive. 허위 경보. 실제로 기능이 의도한 대로 작동하지만 테스트는 실패를 나타냄

**거짓 양성의 영향**
- 단위 테스트의 목표: 프로젝트 성장을 지속 가능하게 하는 것

| 리팩터링 장점                                                                               | 거짓 양성의 단점                                                                                               |
|---------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|
| - 기존 기능 고장 시 테스트가 조기 경고를 제공<br/>- 코드 변경 시 회귀에 대한 보장<br/>  - 확신이 없다면 리팩터링을 하는 데 주저하게 됨 | - 테스트가 타당한 이유 없이 실패하면, 코드 문제 대응 능력과 의지가 희석됨<br/>- 거짓 양성이 빈번하면 테스트 스위트에 대한 신뢰가 서서히 떨어짐<br/>  - 리팩터링이 줄어듬 |

<br/>

#### 1.3 무엇이 거짓 양성의 원인인가

- 거짓 양성의 가능성을 줄이는 방법은 해당 구현 세부 사항에서 테스트를 분리하는 것 뿐
- 테스트를 통해 SUT가 제공하는 최종 결과를 검증하는지 확인해야 함
- 테스트는 최종 사용자의 관점에서 SUT를 검증해야 하고 최종 사용자에게 의미 있는 결과만 확인해야 함




<br/><br/>
